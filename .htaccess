RewriteEngine On

# ✅ Forward Authorization header to PHP
SetEnvIf Authorization "(.*)" HTTP_AUTHORIZATION=$1

# ✅ Allow direct access to static files
RewriteCond %{REQUEST_URI} ^/(css|js|images|views|uploads|assets)/(.*)$ [OR]
RewriteCond %{REQUEST_FILENAME} -f
RewriteRule ^ - [L]

# ✅ Route API requests through index.php for unified handling
RewriteCond %{REQUEST_URI} ^/api/ [NC]
RewriteRule ^api/(.*)$ index.php?route=api/$1 [QSA,L]

# ✅ Prevent direct access to backend directories
RewriteRule ^(App/Controllers|App/Services|config|vendor|logs) - [F,L]

# ✅ Forward remaining requests to public/index.php for FastRoute
RewriteRule ^ index.php [QSA,L]
