RewriteEngine On

# ✅ Forward Authorization header to PHP
SetEnvIf Authorization "(.*)" HTTP_AUTHORIZATION=$1

# ✅ Ensure static files are directly accessible
RewriteCond %{REQUEST_URI} ^/(css|js|images|views|uploads|assets)/(.*)$ [OR]
RewriteCond %{REQUEST_FILENAME} -f
RewriteRule ^ - [L]

# ✅ Route API requests to public/api.php
RewriteCond %{REQUEST_URI} ^/api/ [NC]
RewriteRule ^api/(.*)$ /public/api.php?route=$1 [QSA,L]

# ✅ Prevent direct access to backend directories
RewriteRule ^(App/Controllers|App/Services|config|vendor|logs) - [F,L]

# ✅ Forward all remaining requests to public/index.php for FastRoute handling
RewriteRule ^ public/index.php [QSA,L]
