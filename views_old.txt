=== App/Views/auth/register.php ===
<?php require_once __DIR__ . '/../../Helpers/security.php'; ?>
<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rejestracja - CarFuse</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container">
        <div class="row justify-content-center mt-5">
            <div class="col-md-6">
                <div class="card shadow">
                    <div class="card-body">
                        <h2 class="text-center mb-4">Załóż konto</h2>
                        <div id="alert-container"></div>

                        <form id="registerForm" class="needs-validation" novalidate>
                            <?= csrf_field() ?>
                            
                            <div class="mb-3">
                                <label for="name" class="form-label">Imię i nazwisko</label>
                                <input type="text" class="form-control" id="name" name="name" required>
                                <div class="invalid-feedback">Podaj swoje imię i nazwisko.</div>
                            </div>

                            <div class="mb-3">
                                <label for="email" class="form-label">Adres e-mail</label>
                                <input type="email" class="form-control" id="email" name="email" required>
                                <div class="invalid-feedback">Podaj poprawny adres e-mail.</div>
                            </div>

                            <div class="mb-3">
                                <label for="phone" class="form-label">Numer telefonu</label>
                                <input type="tel" class="form-control" id="phone" name="phone" required>
                                <div class="invalid-feedback">Podaj numer telefonu.</div>
                            </div>

                            <div class="mb-3">
                                <label for="address" class="form-label">Adres</label>
                                <textarea class="form-control" id="address" name="address" rows="2" required></textarea>
                                <div class="invalid-feedback">Podaj swój adres.</div>
                            </div>

                            <div class="mb-3">
                                <label for="password" class="form-label">Hasło</label>
                                <input type="password" class="form-control" id="password" name="password" required minlength="6">
                                <div class="invalid-feedback">Hasło musi mieć co najmniej 6 znaków.</div>
                            </div>

                            <button type="submit" class="btn btn-primary w-100">Zarejestruj się</button>
                        </form>

                        <div class="text-center mt-3">
                            Masz już konto? <a href="/login">Zaloguj się</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        document.getElementById('registerForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const form = this;
            
            if (!form.checkValidity()) {
                form.classList.add('was-validated');
                return;
            }

            const formData = new FormData(form);
            
            fetch('/api/auth/register', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                const alertContainer = document.getElementById('alert-container');
                alertContainer.innerHTML = '';
                
                if (data.status === 'success') {
                    alertContainer.innerHTML = `<div class="alert alert-success">${data.message}</div>`;
                    setTimeout(() => window.location.href = '/login', 2000);
                } else {
                    alertContainer.innerHTML = `<div class="alert alert-danger">${data.message}</div>`;
                }
            })
            .catch(err => {
                console.error('Błąd:', err);
                alertContainer.innerHTML = `<div class="alert alert-danger">Wystąpił błąd podczas rejestracji. Spróbuj ponownie.</div>`;
            });
        });
    </script>
</body>
</html>
=== App/Views/auth/password_reset_request.php ===
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Password Reset - CarFuse</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-5">
        <div class="row justify-content-center">
            <div class="col-md-6">
                <div class="card shadow">
                    <div class="card-body">
                        <h2 class="text-center mb-4">Request Password Reset</h2>
                        
                        <?php if (isset($validation)): ?>
                            <div class="alert alert-danger">
                                <?= $validation->listErrors() ?>
                            </div>
                        <?php endif; ?>

                        <?php if (session()->has('success')): ?>
                            <div class="alert alert-success">
                                <?= esc(session('success')) ?>
                            </div>
                        <?php endif; ?>

                        <form action="<?= site_url('password/request') ?>" method="post" class="needs-validation" novalidate>
                            <?= csrf_field() ?>
                            
                            <div class="mb-3">
                                <label for="email" class="form-label">Email Address</label>
                                <input type="email" class="form-control" id="email" name="email" required value="<?= esc(old('email')) ?>">
                            </div>

                            <button type="submit" class="btn btn-primary w-100">Send Reset Link</button>
                        </form>

                        <div class="text-center mt-3">
                            <a href="<?= site_url('login') ?>">Back to Login</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
=== App/Views/auth/password_reset.php ===
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reset Password - CarFuse</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-5">
        <div class="row justify-content-center">
            <div class="col-md-6">
                <div class="card shadow">
                    <div class="card-body">
                        <h2 class="text-center mb-4">Reset Password</h2>
                        
                        <?php if (isset($validation)): ?>
                            <div class="alert alert-danger">
                                <?= $validation->listErrors() ?>
                            </div>
                        <?php endif; ?>

                        <?php if (session()->has('success')): ?>
                            <div class="alert alert-success">
                                <?= esc(session('success')) ?>
                            </div>
                        <?php endif; ?>

                        <form action="<?= site_url('password/reset') ?>" method="post" class="needs-validation" novalidate>
                            <?= csrf_field() ?>
                            <input type="hidden" name="token" value="<?= esc($token) ?>">

                            <div class="mb-3">
                                <label for="email" class="form-label">Email Address</label>
                                <input type="email" class="form-control" id="email" name="email" required value="<?= esc($email ?? old('email')) ?>">
                            </div>

                            <div class="mb-3">
                                <label for="password" class="form-label">New Password</label>
                                <input type="password" class="form-control" id="password" name="password" required
                                       pattern="^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d]{8,}$">
                                <div class="form-text">Password must be at least 8 characters with letters and numbers.</div>
                            </div>

                            <div class="mb-3">
                                <label for="confirm_password" class="form-label">Confirm New Password</label>
                                <input type="password" class="form-control" id="confirm_password" name="confirm_password" required>
                            </div>

                            <button type="submit" class="btn btn-primary w-100">Reset Password</button>
                        </form>

                        <div class="text-center mt-3">
                            <a href="<?= site_url('login') ?>">Back to Login</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Client-side password validation
        document.getElementById('password').addEventListener('input', function() {
            const isValid = /^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d]{8,}$/.test(this.value);
            this.setCustomValidity(isValid ? '' : 'Password must be at least 8 characters with letters and numbers');
        });

        // Password confirmation validation
        document.getElementById('confirm_password').addEventListener('input', function() {
            const password = document.getElementById('password').value;
            this.setCustomValidity(this.value === password ? '' : 'Passwords do not match');
        });
    </script>
</body>
</html>
=== App/Views/auth/login.php ===
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login - CarFuse</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container">
        <div class="row justify-content-center mt-5">
            <div class="col-md-6">
                <div class="card shadow">
                    <div class="card-body">
                        <h2 class="text-center mb-4">Login</h2>
                        <div id="alert-container"></div>

                        <form id="loginForm" class="needs-validation" novalidate>
                            <?= csrf_field() ?>
                            
                            <div class="mb-3">
                                <label for="email" class="form-label">Email Address</label>
                                <input type="email" class="form-control" id="email" name="email" required>
                            </div>

                            <div class="mb-3">
                                <label for="password" class="form-label">Password</label>
                                <input type="password" class="form-control" id="password" name="password" required>
                            </div>

                            <div class="mb-3 form-check">
                                <input type="checkbox" class="form-check-input" id="remember" name="remember">
                                <label class="form-check-label" for="remember">Remember me</label>
                            </div>

                            <button type="submit" class="btn btn-primary w-100">Login</button>
                        </form>

                        <div class="text-center mt-3">
                            <a href="<?= site_url('password/reset') ?>">Forgot your password?</a>
                        </div>

                        <div class="text-center mt-3">
                            <a href="<?= site_url('register') ?>">Don't have an account? Register here</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        document.getElementById('loginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const formData = new FormData(this);
            fetch('<?= site_url('api/auth/login') ?>', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                const alertContainer = document.getElementById('alert-container');
                alertContainer.innerHTML = '';
                if (data.status === 'success') {
                    alertContainer.innerHTML = `<div class="alert alert-success">${data.message}</div>`;
                    window.location.href = '<?= site_url('dashboard') ?>';
                } else {
                    alertContainer.innerHTML = `<div class="alert alert-danger">${data.message}</div>`;
                }
            })
            .catch(err => console.error('Error:', err));
        });
    </script>
</body>
</html>
=== App/Views/admin/payments/dashboard.php ===
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Payment Dashboard - CarFuse</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="container mt-5">
        <h2 class="text-center">Payment Dashboard</h2>

        <!-- Summary Stats -->
        <div class="row mt-4">
            <div class="col-md-4">
                <div class="card shadow">
                    <div class="card-body text-center">
                        <h4>Total Payments</h4>
                        <p id="totalPayments" class="display-6">0</p>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card shadow">
                    <div class="card-body text-center">
                        <h4>Total Refunds</h4>
                        <p id="totalRefunds" class="display-6">0</p>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card shadow">
                    <div class="card-body text-center">
                        <h4>Total Transactions</h4>
                        <p id="totalTransactions" class="display-6">0</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Graphs Section -->
        <div class="row mt-5">
            <!-- Booking Trends -->
            <div class="col-md-6">
                <div class="card shadow">
                    <div class="card-body">
                        <h5 class="text-center">Monthly Booking Trends</h5>
                        <canvas id="bookingTrends"></canvas>
                    </div>
                </div>
            </div>

            <!-- Revenue Trends -->
            <div class="col-md-6">
                <div class="card shadow">
                    <div class="card-body">
                        <h5 class="text-center">Monthly Revenue Trends</h5>
                        <canvas id="revenueTrends"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        async function loadDashboardStats() {
            try {
                const response = await fetch('/admin/payments/dashboard/stats');
                const data = await response.json();

                if (data.status === 'success') {
                    // Update stats
                    document.getElementById('totalPayments').textContent = data.totalPayments;
                    document.getElementById('totalRefunds').textContent = data.totalRefunds;
                    document.getElementById('totalTransactions').textContent = data.totalTransactions;

                    // Load graphs
                    loadBookingTrends(data.bookingTrends);
                    loadRevenueTrends(data.revenueTrends);
                } else {
                    console.error('Failed to load dashboard stats');
                }
            } catch (error) {
                console.error('Error loading dashboard stats:', error);
            }
        }

        function loadBookingTrends(data) {
            const ctx = document.getElementById('bookingTrends').getContext('2d');
            const labels = data.map(item => `Month ${item.month}`);
            const values = data.map(item => item.total);

            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Bookings',
                        data: values,
                        borderColor: 'blue',
                        fill: false,
                        tension: 0.3
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            display: true,
                            position: 'top'
                        }
                    }
                }
            });
        }

        function loadRevenueTrends(data) {
            const ctx = document.getElementById('revenueTrends').getContext('2d');
            const labels = data.map(item => `Month ${item.month}`);
            const values = data.map(item => item.total);

            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Revenue',
                        data: values,
                        borderColor: 'green',
                        fill: false,
                        tension: 0.3
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            display: true,
                            position: 'top'
                        }
                    }
                }
            });
        }

        document.addEventListener('DOMContentLoaded', loadDashboardStats);
    </script>
</body>
</html>
=== App/Views/admin/payments/transactions.php ===
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Transaction History - Admin</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-5">
        <h2 class="text-center">Transaction History</h2>
        <table class="table table-bordered mt-4">
            <thead>
                <tr>
                    <th>Transaction ID</th>
                    <th>User ID</th>
                    <th>Booking ID</th>
                    <th>Amount</th>
                    <th>Type</th>
                    <th>Status</th>
                    <th>Date</th>
                </tr>
            </thead>
            <tbody id="transactionList">
                <!-- Dynamic data will be loaded here -->
            </tbody>
        </table>
    </div>

    <script>
        async function loadTransactions() {
            try {
                const response = await fetch('/admin/transactions');
                const data = await response.json();

                const tableBody = document.getElementById('transactionList');
                if (data.status === 'success') {
                    tableBody.innerHTML = '';
                    data.transactions.forEach(transaction => {
                        const row = document.createElement('tr');
                        row.innerHTML = `
                            <td>${transaction.id}</td>
                            <td>${transaction.user_id}</td>
                            <td>${transaction.booking_id || 'N/A'}</td>
                            <td>${transaction.amount}</td>
                            <td>${transaction.type}</td>
                            <td>${transaction.status}</td>
                            <td>${transaction.created_at}</td>
                        `;
                        tableBody.appendChild(row);
                    });
                } else {
                    tableBody.innerHTML = '<tr><td colspan="7" class="text-center">No transactions found</td></tr>';
                }
            } catch (error) {
                console.error('Error loading transactions:', error);
            }
        }

        document.addEventListener('DOMContentLoaded', loadTransactions);
    </script>
</body>
</html>
=== App/Views/admin/payments/refunds.php ===
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Refunds - Admin</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-5">
        <h2 class="text-center">Manage Refunds</h2>
        <table class="table table-bordered mt-4">
            <thead>
                <tr>
                    <th>Refund ID</th>
                    <th>User ID</th>
                    <th>Transaction ID</th>
                    <th>Amount</th>
                    <th>Status</th>
                    <th>Reason</th>
                    <th>Date</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody id="refundsList">
                <!-- Dynamic data will be loaded here -->
            </tbody>
        </table>
    </div>

    <script>
        async function loadRefunds() {
            try {
                const response = await fetch('/admin/refunds');
                const data = await response.json();

                const tableBody = document.getElementById('refundsList');
                if (data.status === 'success') {
                    tableBody.innerHTML = '';
                    data.refunds.forEach(refund => {
                        const row = document.createElement('tr');
                        row.innerHTML = `
                            <td>${refund.id}</td>
                            <td>${refund.user_id}</td>
                            <td>${refund.transaction_id}</td>
                            <td>${refund.amount}</td>
                            <td>${refund.status}</td>
                            <td>${refund.reason}</td>
                            <td>${refund.date}</td>
                            <td>
                                <button class="btn btn-success btn-sm" onclick="approveRefund(${refund.id})">Approve</button>
                                <button class="btn btn-danger btn-sm" onclick="rejectRefund(${refund.id})">Reject</button>
                            </td>
                        `;
                        tableBody.appendChild(row);
                    });
                } else {
                    tableBody.innerHTML = '<tr><td colspan="8" class="text-center">No refunds found</td></tr>';
                }
            } catch (error) {
                console.error('Error loading refunds:', error);
            }
        }

        async function approveRefund(id) {
            // Approve refund logic here
        }

        async function rejectRefund(id) {
            // Reject refund logic here
        }

        document.addEventListener('DOMContentLoaded', loadRefunds);
    </script>
</body>
</html>
=== App/Views/admin/dashboard.php ===
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - CarFuse</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="/public/css/styles.css">
    <script src="/public/js/dashboard.js"></script>
</head>
<body>
    <div class="container mt-5">
        <h1 class="text-center">Admin Dashboard</h1>
        <div class="row mt-4">
            <!-- Metrics Cards -->
            <div class="col-md-4">
                <div class="card shadow">
                    <div class="card-body">
                        <h5>Total Users</h5>
                        <p class="fs-4" id="totalUsers">0</p>
                        <p>Active: <span id="activeUsers">0</span></p>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card shadow">
                    <div class="card-body">
                        <h5>Total Bookings</h5>
                        <p class="fs-4" id="totalBookings">0</p>
                        <p>Completed: <span id="completedBookings">0</span>, Canceled: <span id="canceledBookings">0</span></p>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card shadow">
                    <div class="card-body">
                        <h5>Total Revenue</h5>
                        <p class="fs-4" id="totalRevenue">$0.00</p>
                        <p>Refunds: $<span id="totalRefunds">0.00</span></p>
                        <p>Net: $<span id="netRevenue">0.00</span></p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Graphs Section -->
        <div class="row mt-5">
            <div class="col-md-6">
                <h4>Booking Trends</h4>
                <canvas id="bookingTrends"></canvas>
            </div>
            <div class="col-md-6">
                <h4>Revenue Trends</h4>
                <canvas id="revenueTrends"></canvas>
            </div>
        </div>
    </div>

    <script>
        // Load data dynamically
        async function loadDashboardData() {
            try {
                const response = await fetch('/admin/dashboard/data');
                const data = await response.json();

                if (data.status === 'success') {
                    // Update Metrics
                    document.getElementById('totalUsers').textContent = data.metrics.total_users;
                    document.getElementById('activeUsers').textContent = data.metrics.active_users;

                    document.getElementById('totalBookings').textContent = data.metrics.total_bookings;
                    document.getElementById('completedBookings').textContent = data.metrics.completed_bookings;
                    document.getElementById('canceledBookings').textContent = data.metrics.canceled_bookings;

                    document.getElementById('totalRevenue').textContent = `$${data.metrics.total_revenue.toFixed(2)}`;
                    document.getElementById('totalRefunds').textContent = data.metrics.total_refunds.toFixed(2);
                    document.getElementById('netRevenue').textContent = data.metrics.net_revenue.toFixed(2);

                    // Update Graphs
                    loadGraph('bookingTrends', 'line', data.bookingTrends.labels, data.bookingTrends.data, 'Bookings', 'blue');
                    loadGraph('revenueTrends', 'line', data.revenueTrends.labels, data.revenueTrends.data, 'Revenue', 'green');
                } else {
                    console.error('Failed to fetch dashboard data');
                }
            } catch (error) {
                console.error('Error loading dashboard data:', error);
            }
        }

        // Load Graph
        function loadGraph(canvasId, type, labels, data, label, color) {
            const ctx = document.getElementById(canvasId).getContext('2d');
            new Chart(ctx, {
                type: type,
                data: {
                    labels: labels,
                    datasets: [{
                        label: label,
                        data: data,
                        borderColor: color,
                        fill: false,
                        tension: 0.3,
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            display: true,
                            position: 'top',
                        }
                    }
                }
            });
        }

        document.addEventListener('DOMContentLoaded', loadDashboardData);
    </script>
</body>
</html>
=== App/Views/admin/logs.php ===
=== App/Views/admin/reports.php ===
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Reports - CarFuse</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-5">
        <h1 class="text-center">Admin Reports</h1>
        <form id="adminReportForm" class="mt-4">
            <div class="mb-3">
                <label for="reportType" class="form-label">Report Type</label>
                <select class="form-select" id="reportType" name="reportType" required>
                    <option value="" disabled selected>Select Report Type</option>
                    <option value="bookings">Bookings</option>
                    <option value="payments">Payments</option>
                    <option value="users">Users</option>
                </select>
            </div>
            <div class="mb-3">
                <label for="startDate" class="form-label">Start Date</label>
                <input type="date" class="form-control" id="startDate" name="startDate" required>
            </div>
            <div class="mb-3">
                <label for="endDate" class="form-label">End Date</label>
                <input type="date" class="form-control" id="endDate" name="endDate" required>
            </div>
            <div class="mb-3">
                <label for="format" class="form-label">Report Format</label>
                <select class="form-select" id="format" name="format" required>
                    <option value="csv">CSV</option>
                    <option value="pdf">PDF</option>
                </select>
            </div>
            <button type="submit" class="btn btn-primary w-100">Generate Report</button>
        </form>
        <div id="responseMessage" class="mt-3"></div>
    </div>

    <script>
        document.getElementById('adminReportForm').addEventListener('submit', async function (e) {
            e.preventDefault();
            
            const formData = new FormData(e.target);
            const payload = Object.fromEntries(formData.entries());

            try {
                const response = await fetch('/admin/reports/generate', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                const result = await response.json();
                const messageDiv = document.getElementById('responseMessage');

                if (result.status === 'success') {
                    messageDiv.innerHTML = `<div class="alert alert-success">Report generated: <a href="${result.filePath}" download>Download Report</a></div>`;
                } else {
                    messageDiv.innerHTML = `<div class="alert alert-danger">${result.message}</div>`;
                }
            } catch (error) {
                console.error('Error generating report:', error);
                document.getElementById('responseMessage').innerHTML = `<div class="alert alert-danger">An error occurred.</div>`;
            }
        });
    </script>
</body>
</html>
=== App/Views/layouts/header.php ===
<?php
// Path: App/Views/layouts/header.php
?>
<header>
    <div class="logo">
        <img src="/public/images/logo.png" alt="Carfuse" style="height: 55px; width: auto;">
    </div>
</header>

<nav>
    <a href="#home">Strona główna</a>
    <a href="#features">Dlaczego my?</a>
    <a href="/login">Zaloguj się</a>
    <a href="/register">Załóż konto</a>
</nav>
=== App/Views/layouts/footer.php ===
<?php
// Path: App/Views/layouts/footer.php
?>
<footer class="footer">
    &copy; <?= date("Y"); ?> Carfuse. Wszystkie prawa zastrzeżone. | <a href="/terms">Regulamin</a> | <a href="/privacy">Polityka prywatności</a>
</footer>
=== App/Views/layouts/sidebar.php ===
<aside class="sidebar">
    <nav class="sidebar-menu">
        <ul>
            <li class="<?php echo ($activePage == 'dashboard') ? 'active' : ''; ?>">
                <a href="/dashboard">Dashboard</a>
            </li>
            <?php if ($userRole == 'admin'): ?>
                <li class="<?php echo ($activePage == 'users') ? 'active' : ''; ?>">
                    <a href="/users">Manage Users</a>
                </li>
                <li class="<?php echo ($activePage == 'logs') ? 'active' : ''; ?>">
                    <a href="/logs">View Logs</a>
                </li>
                <li class="<?php echo ($activePage == 'reports') ? 'active' : ''; ?>">
                    <a href="/reports">Generate Reports</a>
                </li>
            <?php endif; ?>
            <?php if ($userRole == 'user'): ?>
                <li class="<?php echo ($activePage == 'documents') ? 'active' : ''; ?>">
                    <a href="/documents">My Documents</a>
                </li>
                <li class="<?php echo ($activePage == 'profile') ? 'active' : ''; ?>">
                    <a href="/profile">My Profile</a>
                </li>
            <?php endif; ?>
        </ul>
    </nav>
</aside>

<style>
/* Ensure accessibility & responsive behavior */
.sidebar {
    width: 250px;
    background-color: #333;
    color: #fff;
    position: fixed;
    height: 100%;
    overflow: auto;
}

.sidebar-nav ul {
    list-style-type: none;
    padding: 0;
}

.sidebar-nav ul li {
    padding: 15px;
    text-align: left;
}

.sidebar-nav ul li a {
    color: #fff;
    text-decoration: none;
    display: block;
}

.sidebar-nav ul li a:hover {
    background-color: #575757;
}

@media screen and (max-width: 768px) {
    .sidebar {
        width: 100%;
        height: auto;
        position: relative;
    }
    .sidebar-nav ul li {
        float: left;
    }
    .sidebar-nav ul li a {
        text-align: center;
        padding: 10px;
    }
}
</style>
=== App/Views/layouts/footer_old.php ===
<footer>
    <div class="footer-content">
        <div class="footer-branding">
            <img src="/path/to/branding/logo.png" alt="Brand Logo">
        </div>
        <div class="footer-legal">
            <p>&copy; <?php echo date('Y'); ?> Your Company. All rights reserved.</p>
            <p><a href="/terms">Terms of Service</a> | <a href="/privacy">Privacy Policy</a></p>
        </div>
        <div class="footer-contact">
            <p>Contact us: <a href="mailto:support@yourcompany.com">support@yourcompany.com</a></p>
            <p>Phone: (123) 456-7890</p>
        </div>
    </div>
</footer>
</body>
</html>
=== App/Views/layouts/header_old.php ===
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard</title>
    <link rel="stylesheet" href="/public/css/admin.css">
    <link rel="stylesheet" href="/path/to/your/css/styles.css">
</head>
<body>
    <header>
        <nav class="navbar">
            <div class="navbar-brand">
                <a href="/"><img src="/path/to/branding/logo.png" alt="Brand Logo"></a>
            </div>
            <ul class="navbar-menu">
                <li class="navbar-item <?php echo ($activePage == 'home') ? 'active' : ''; ?>">
                    <a href="/">Home</a>
                </li>
                <li class="navbar-item <?php echo ($activePage == 'documents') ? 'active' : ''; ?>">
                    <a href="/documents">Documents</a>
                </li>
                <li class="navbar-item <?php echo ($activePage == 'about') ? 'active' : ''; ?>">
                    <a href="/about">About</a>
                </li>
                <li><a href="/dashboard">Dashboard</a></li>
                <li><a href="/logs">Logs</a></li>
                <li><a href="/reports">Reports</a></li>
            </ul>
            <div class="navbar-profile">
                <?php if (isset($user)): ?>
                    <div class="profile-dropdown">
                        <button class="profile-button"><?php echo htmlspecialchars($user['name']); ?></button>
                        <div class="profile-menu">
                            <a href="/profile">Profile</a>
                            <a href="/logout">Logout</a>
                        </div>
                    </div>
                <?php else: ?>
                    <a href="/login" class="login-button">Login</a>
                <?php endif; ?>
            </div>
        </nav>
    </header>
    <!-- ...existing code... -->
</body>
</html>
=== App/Views/payments/make_payment.php ===
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Make Payment - CarFuse</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-5">
        <h2 class="text-center">Make a Payment</h2>
        <form id="paymentForm">
            <div class="mb-3">
                <label for="user_id" class="form-label">User ID</label>
                <input type="number" class="form-control" id="user_id" name="user_id" required>
            </div>
            <div class="mb-3">
                <label for="amount" class="form-label">Amount</label>
                <input type="number" class="form-control" id="amount" name="amount" step="0.01" required>
            </div>
            <div class="mb-3">
                <label for="payment_method_id" class="form-label">Payment Method</label>
                <select class="form-select" id="payment_method_id" name="payment_method_id" required>
                    <option value="" disabled selected>Select a Payment Method</option>
                    <option value="1">Credit Card</option>
                    <option value="2">PayPal</option>
                    <option value="3">Bank Transfer</option>
                </select>
            </div>
            <button type="submit" class="btn btn-primary w-100">Submit Payment</button>
        </form>
        <div id="responseMessage" class="mt-3"></div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        document.getElementById('paymentForm').addEventListener('submit', async function (e) {
            e.preventDefault();
            
            const formData = new FormData(e.target);
            const payload = Object.fromEntries(formData.entries());
            
            try {
                const response = await fetch('/payment/process', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                
                const result = await response.json();
                const messageDiv = document.getElementById('responseMessage');
                
                if (result.status === 'success') {
                    messageDiv.innerHTML = `<div class="alert alert-success">Payment processed successfully!</div>`;
                } else {
                    messageDiv.innerHTML = `<div class="alert alert-danger">${result.message}</div>`;
                }
            } catch (error) {
                console.error('Payment processing failed:', error);
                document.getElementById('responseMessage').innerHTML = `<div class="alert alert-danger">An error occurred.</div>`;
            }
        });
    </script>
</body>
</html>
=== App/Views/payments/methods.php ===
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manage Payment Methods - CarFuse</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-5">
        <h2 class="text-center">Manage Payment Methods</h2>
        <div id="responseMessage" class="mt-3"></div>
        <form id="addMethodForm" class="mt-4">
            <h4>Add New Payment Method</h4>
            <div class="mb-3">
                <label for="method_name" class="form-label">Payment Method Name</label>
                <input type="text" class="form-control" id="method_name" name="method_name" required>
            </div>
            <div class="mb-3">
                <label for="details" class="form-label">Details</label>
                <textarea class="form-control" id="details" name="details" rows="2" required></textarea>
            </div>
            <button type="submit" class="btn btn-primary w-100">Add Payment Method</button>
        </form>

        <h4 class="mt-5">Existing Payment Methods</h4>
        <table class="table table-bordered mt-3">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Method Name</th>
                    <th>Details</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody id="paymentMethods">
                <!-- Dynamic Data -->
            </tbody>
        </table>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        async function loadPaymentMethods() {
            try {
                const response = await fetch('/payment/methods');
                const data = await response.json();
                const tableBody = document.getElementById('paymentMethods');

                if (data.status === 'success') {
                    tableBody.innerHTML = '';
                    data.methods.forEach(method => {
                        const row = document.createElement('tr');
                        row.innerHTML = `
                            <td>${method.id}</td>
                            <td>${method.name}</td>
                            <td>${method.details}</td>
                            <td>
                                <button class="btn btn-danger btn-sm" onclick="deletePaymentMethod(${method.id})">Delete</button>
                            </td>
                        `;
                        tableBody.appendChild(row);
                    });
                } else {
                    tableBody.innerHTML = `<tr><td colspan="4" class="text-center">No payment methods found.</td></tr>`;
                }
            } catch (error) {
                console.error('Error loading payment methods:', error);
            }
        }

        async function deletePaymentMethod(id) {
            try {
                const response = await fetch(`/payment/methods/delete/${id}`, { method: 'DELETE' });
                const data = await response.json();

                if (data.status === 'success') {
                    alert('Payment method deleted successfully.');
                    loadPaymentMethods();
                } else {
                    alert('Failed to delete payment method.');
                }
            } catch (error) {
                console.error('Error deleting payment method:', error);
            }
        }

        document.getElementById('addMethodForm').addEventListener('submit', async function (e) {
            e.preventDefault();
            const formData = new FormData(e.target);
            const payload = Object.fromEntries(formData.entries());

            try {
                const response = await fetch('/payment/methods/add', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                const result = await response.json();

                if (result.status === 'success') {
                    document.getElementById('responseMessage').innerHTML = '<div class="alert alert-success">Payment method added successfully!</div>';
                    loadPaymentMethods();
                } else {
                    document.getElementById('responseMessage').innerHTML = `<div class="alert alert-danger">${result.message}</div>`;
                }
            } catch (error) {
                console.error('Error adding payment method:', error);
            }
        });

        document.addEventListener('DOMContentLoaded', loadPaymentMethods);
    </script>
</body>
</html>
=== App/Views/payments/history.php ===
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Transaction History - CarFuse</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-5">
        <h2 class="text-center">Transaction History</h2>
        <table class="table table-bordered mt-3">
            <thead>
                <tr>
                    <th>Transaction ID</th>
                    <th>User ID</th>
                    <th>Booking ID</th>
                    <th>Amount</th>
                    <th>Type</th>
                    <th>Status</th>
                    <th>Date</th>
                </tr>
            </thead>
            <tbody id="transactionHistory">
                <!-- Dynamic Data -->
            </tbody>
        </table>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        async function loadTransactionHistory() {
            try {
                const response = await fetch('/payment/transactions');
                const data = await response.json();
                const tableBody = document.getElementById('transactionHistory');

                if (data.status === 'success') {
                    tableBody.innerHTML = '';
                    data.transactions.forEach(transaction => {
                        const row = document.createElement('tr');
                        row.innerHTML = `
                            <td>${transaction.id}</td>
                            <td>${transaction.user_id}</td>
                            <td>${transaction.booking_id ?? 'N/A'}</td>
                            <td>${transaction.amount}</td>
                            <td>${transaction.type}</td>
                            <td>${transaction.status}</td>
                            <td>${transaction.created_at}</td>
                        `;
                        tableBody.appendChild(row);
                    });
                } else {
                    tableBody.innerHTML = `<tr><td colspan="7" class="text-center">No transactions found.</td></tr>`;
                }
            } catch (error) {
                console.error('Error loading transaction history:', error);
            }
        }

        document.addEventListener('DOMContentLoaded', loadTransactionHistory);
    </script>
</body>
</html>
=== App/Views/payments/refund.php ===
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Process Refund - CarFuse</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-5">
        <h2 class="text-center">Process Refund</h2>
        <form id="refundForm">
            <div class="mb-3">
                <label for="transaction_id" class="form-label">Transaction ID</label>
                <input type="number" class="form-control" id="transaction_id" name="transaction_id" required>
            </div>
            <div class="mb-3">
                <label for="amount" class="form-label">Amount</label>
                <input type="number" class="form-control" id="amount" name="amount" step="0.01" required>
            </div>
            <button type="submit" class="btn btn-danger w-100">Submit Refund</button>
        </form>
        <div id="responseMessage" class="mt-3"></div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        document.getElementById('refundForm').addEventListener('submit', async function (e) {
            e.preventDefault();
            
            const formData = new FormData(e.target);
            const payload = Object.fromEntries(formData.entries());
            
            try {
                const response = await fetch('/payment/refund', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                
                const result = await response.json();
                const messageDiv = document.getElementById('responseMessage');
                
                if (result.status === 'success') {
                    messageDiv.innerHTML = `<div class="alert alert-success">Refund processed successfully!</div>`;
                } else {
                    messageDiv.innerHTML = `<div class="alert alert-danger">${result.message}</div>`;
                }
            } catch (error) {
                console.error('Refund processing failed:', error);
                document.getElementById('responseMessage').innerHTML = `<div class="alert alert-danger">An error occurred.</div>`;
            }
        });
    </script>
</body>
</html>
=== App/Views/user/profile.php ===
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profile - CarFuse</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-5">
        <h2 class="text-center">Profile</h2>
        <form id="profileForm" action="<?= site_url('profile/update') ?>" method="post">
            <?= csrf_field() ?>

            <div class="mb-3">
                <label for="name" class="form-label">Full Name</label>
                <input type="text" class="form-control" id="name" name="name" required value="<?= esc($user->name) ?>">
            </div>

            <div class="mb-3">
                <label for="phone" class="form-label">Phone Number</label>
                <input type="tel" class="form-control" id="phone" name="phone" required value="<?= esc($user->phone) ?>" pattern="[0-9]{10,}">
            </div>

            <div class="mb-3">
                <label for="address" class="form-label">Address</label>
                <textarea class="form-control" id="address" name="address" rows="2" required><?= esc($user->address) ?></textarea>
            </div>

            <button type="submit" class="btn btn-primary w-100">Update Profile</button>
        </form>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
=== App/Views/user/dashboard.php ===
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User Dashboard - CarFuse</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/public/css/styles.css">
    <script src="/public/js/dashboard.js"></script>
</head>
<body>
    <div class="container mt-5">
        <h2 class="text-center">User Dashboard</h2>
        <div class="card shadow mt-3">
            <div class="card-body">
                <h4 class="mb-4">My Bookings</h4>
                <table class="table table-bordered">
                    <thead>
                        <tr>
                            <th>Booking ID</th>
                            <th>Vehicle</th>
                            <th>Pickup Date</th>
                            <th>Dropoff Date</th>
                            <th>Status</th>
                            <th>Payment</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="bookingHistory">
                        <!-- Dynamic data will be loaded here -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        async function loadBookingHistory() {
            try {
                const response = await fetch('/api/bookings');
                const data = await response.json();

                if (data.status === 'success') {
                    const bookings = data.bookings;
                    const tableBody = document.getElementById('bookingHistory');
                    tableBody.innerHTML = '';

                    bookings.forEach(booking => {
                        const row = document.createElement('tr');
                        row.innerHTML = `
                            <td>${booking.id}</td>
                            <td>${booking.vehicle_name}</td>
                            <td>${booking.pickup_date}</td>
                            <td>${booking.dropoff_date}</td>
                            <td>${booking.status}</td>
                            <td>${booking.payment_status}</td>
                            <td>
                                <button onclick="viewBooking(${booking.id})" class="btn btn-info btn-sm">Details</button>
                                <button onclick="rescheduleBooking(${booking.id})" class="btn btn-warning btn-sm">Reschedule</button>
                                <button onclick="cancelBooking(${booking.id})" class="btn btn-danger btn-sm">Cancel</button>
                            </td>
                        `;
                        tableBody.appendChild(row);
                    });
                } else {
                    alert('Failed to fetch booking history');
                }
            } catch (error) {
                console.error('Error loading booking history:', error);
            }
        }

        async function viewBooking(id) {
            try {
                const response = await fetch(`/api/bookings/${id}`);
                const booking = await response.json();
                if (booking.status === 'success') {
                    alert(JSON.stringify(booking.data, null, 2));
                } else {
                    alert('Failed to fetch booking details');
                }
            } catch (error) {
                console.error('Error viewing booking:', error);
            }
        }

        async function rescheduleBooking(id) {
            const pickupDate = prompt("Enter new pickup date (YYYY-MM-DD):");
            const dropoffDate = prompt("Enter new dropoff date (YYYY-MM-DD):");

            if (!pickupDate || !dropoffDate) return;

            try {
                const response = await fetch(`/api/bookings/${id}/reschedule`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ pickup_date: pickupDate, dropoff_date: dropoffDate })
                });
                const result = await response.json();

                if (result.status === 'success') {
                    alert('Booking rescheduled successfully');
                    loadBookingHistory();
                } else {
                    alert(result.message || 'Failed to reschedule booking');
                }
            } catch (error) {
                console.error('Error rescheduling booking:', error);
            }
        }

        async function cancelBooking(id) {
            if (!confirm('Are you sure you want to cancel this booking?')) return;

            try {
                const response = await fetch(`/api/bookings/${id}/cancel`, { method: 'DELETE' });
                const result = await response.json();

                if (result.status === 'success') {
                    alert('Booking canceled successfully');
                    loadBookingHistory();
                } else {
                    alert(result.message || 'Failed to cancel booking');
                }
            } catch (error) {
                console.error('Error canceling booking:', error);
            }
        }

        document.addEventListener('DOMContentLoaded', loadBookingHistory);
    </script>
</body>
</html>
=== App/Views/user/notifications.php ===
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Notifications - CarFuse</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-5">
        <h2 class="text-center">My Notifications</h2>

        <div class="card shadow mt-3">
            <div class="card-body">
                <h4 class="mb-4">Notifications</h4>
                <table class="table table-bordered">
                    <thead>
                        <tr>
                            <th>Type</th>
                            <th>Message</th>
                            <th>Date</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="notificationTable">
                        <!-- Dynamic data will be loaded here -->
                    </tbody>
                </table>
            </div>
        </div>

        <div class="card shadow mt-4">
            <div class="card-body">
                <h4 class="mb-4">Notification Settings</h4>
                <form id="notificationSettingsForm">
                    <div class="form-check mb-3">
                        <input class="form-check-input" type="checkbox" id="emailNotifications" name="emailNotifications">
                        <label class="form-check-label" for="emailNotifications">Enable Email Notifications</label>
                    </div>
                    <div class="form-check mb-3">
                        <input class="form-check-input" type="checkbox" id="smsNotifications" name="smsNotifications">
                        <label class="form-check-label" for="smsNotifications">Enable SMS Notifications</label>
                    </div>
                    <button type="submit" class="btn btn-primary">Save Settings</button>
                </form>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        async function loadNotifications() {
            try {
                const response = await fetch('/notifications');
                const data = await response.json();

                if (data.status === 'success') {
                    const notifications = data.notifications;
                    const tableBody = document.getElementById('notificationTable');
                    tableBody.innerHTML = '';

                    notifications.forEach(notification => {
                        const row = document.createElement('tr');
                        row.innerHTML = `
                            <td>${notification.type}</td>
                            <td>${notification.message}</td>
                            <td>${new Date(notification.sent_at).toLocaleString()}</td>
                            <td>${notification.is_read ? 'Read' : 'Unread'}</td>
                            <td>
                                ${notification.is_read ? '' : `<button class="btn btn-sm btn-success" onclick="markAsRead(${notification.id})">Mark as Read</button>`}
                                <button class="btn btn-sm btn-danger" onclick="deleteNotification(${notification.id})">Delete</button>
                            </td>
                        `;
                        tableBody.appendChild(row);
                    });
                } else {
                    alert('Failed to fetch notifications');
                }
            } catch (error) {
                console.error('Error loading notifications:', error);
            }
        }

        async function markAsRead(id) {
            try {
                const response = await fetch('/notifications/mark-as-read', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ notificationId: id })
                });
                const data = await response.json();
                if (data.status === 'success') {
                    loadNotifications();
                } else {
                    alert('Failed to mark notification as read');
                }
            } catch (error) {
                console.error('Error marking notification as read:', error);
            }
        }

        async function deleteNotification(id) {
            try {
                const response = await fetch('/notifications/delete', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ notificationId: id })
                });
                const data = await response.json();
                if (data.status === 'success') {
                    loadNotifications();
                } else {
                    alert('Failed to delete notification');
                }
            } catch (error) {
                console.error('Error deleting notification:', error);
            }
        }

        document.getElementById('notificationSettingsForm').addEventListener('submit', async function (event) {
            event.preventDefault();
            const emailNotifications = document.getElementById('emailNotifications').checked;
            const smsNotifications = document.getElementById('smsNotifications').checked;

            try {
                const response = await fetch('/notifications/settings', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        emailNotifications,
                        smsNotifications
                    })
                });
                const data = await response.json();
                if (data.status === 'success') {
                    alert('Settings updated successfully');
                } else {
                    alert('Failed to update settings');
                }
            } catch (error) {
                console.error('Error updating settings:', error);
            }
        });

        document.addEventListener('DOMContentLoaded', () => {
            loadNotifications();
        });
    </script>
</body>
</html>
=== App/Views/user/documents.php ===
=== App/Views/user/reports.php ===
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User Reports - CarFuse</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-5">
        <h1 class="text-center">My Reports</h1>
        <form id="userReportForm" class="mt-4">
            <div class="mb-3">
                <label for="reportType" class="form-label">Report Type</label>
                <select class="form-select" id="reportType" name="reportType" required>
                    <option value="" disabled selected>Select Report Type</option>
                    <option value="bookings">My Bookings</option>
                    <option value="payments">My Payments</option>
                </select>
            </div>
            <div class="mb-3">
                <label for="startDate" class="form-label">Start Date</label>
                <input type="date" class="form-control" id="startDate" name="startDate" required>
            </div>
            <div class="mb-3">
                <label for="endDate" class="form-label">End Date</label>
                <input type="date" class="form-control" id="endDate" name="endDate" required>
            </div>
            <div class="mb-3">
                <label for="format" class="form-label">Report Format</label>
                <select class="form-select" id="format" name="format" required>
                    <option value="csv">CSV</option>
                    <option value="pdf">PDF</option>
                </select>
            </div>
            <button type="submit" class="btn btn-primary w-100">Generate Report</button>
        </form>
        <div id="responseMessage" class="mt-3"></div>
    </div>

    <script>
        document.getElementById('userReportForm').addEventListener('submit', async function (e) {
            e.preventDefault();
            
            const formData = new FormData(e.target);
            const payload = Object.fromEntries(formData.entries());

            try {
                const response = await fetch('/user/reports/generate', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                const result = await response.json();
                const messageDiv = document.getElementById('responseMessage');

                if (result.status === 'success') {
                    messageDiv.innerHTML = `<div class="alert alert-success">Report generated: <a href="${result.filePath}" download>Download Report</a></div>`;
                } else {
                    messageDiv.innerHTML = `<div class="alert alert-danger">${result.message}</div>`;
                }
            } catch (error) {
                console.error('Error generating report:', error);
                document.getElementById('responseMessage').innerHTML = `<div class="alert alert-danger">An error occurred.</div>`;
            }
        });
    </script>
</body>
</html>
=== App/Views/bookings/view.php ===
=== App/Views/bookings/create.php ===
=== App/Views/landing.php ===
<?php
// Path: App/Views/landing.php
?>

<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Carfuse - Wynajmij auto szybko i łatwo</title>
    <link rel="stylesheet" href="/assets/css/style.css">
    <style>
        /* Dark Minimal Theme */
        body {
            background-color: #121212;
            color: #fff;
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
        }
        header {
            background-color: #181818;
            text-align: center;
            padding: 15px 0;
        }
        .logo img {
            max-height: 104px;
            margin: 15px 0;
        }
        nav {
            display: flex;
            justify-content: center;
            padding: 15px 0;
        }
        nav a {
            color: #fff;
            text-decoration: none;
            margin: 0 15px;
            font-size: 18px;
        }
        nav a:hover {
            color: #FFD700;
        }
        .hero {
            text-align: center;
            padding: 100px 20px;
            background: url('/assets/images/hero-bg.jpg') no-repeat center center/cover;
        }
        .hero h1 {
            font-size: 48px;
            margin-bottom: 20px;
            text-shadow: 2px 2px 8px rgba(0, 0, 0, 0.8);
        }
        .hero p {
            font-size: 20px;
            opacity: 0.8;
            margin-bottom: 30px;
        }
        .search-form {
            display: flex;
            justify-content: center;
            gap: 10px;
        }
        .search-form input, .search-form button {
            padding: 12px;
            font-size: 16px;
            border-radius: 5px;
            border: none;
        }
        .search-form button {
            background: #FFD700;
            color: #121212;
            font-weight: bold;
            cursor: pointer;
        }
        .search-form button:hover {
            background: #FFC107;
        }
        .features {
            text-align: center;
            padding: 60px 20px;
        }
        .features h2 {
            font-size: 36px;
            margin-bottom: 20px;
        }
        .feature-list {
            display: flex;
            justify-content: center;
            gap: 50px;
        }
        .feature {
            font-size: 18px;
            background: #181818;
            padding: 20px;
            border-radius: 5px;
        }
        .footer {
            text-align: center;
            padding: 20px;
            background: #181818;
            opacity: 0.8;
        }
    </style>
</head>
<body>

<?php include __DIR__ . '/layouts/header.php'; ?>

<section class="hero">
    <h1>Znajdź idealne auto na swoją podróż</h1>
    <p>Elastyczny wynajem, najlepsze ceny i wsparcie 24/7.</p>
    <form class="search-form" action="/search" method="GET">
        <input type="text" name="location" placeholder="Wpisz lokalizację odbioru">
        <input type="date" name="pickup_date">
        <input type="date" name="return_date">
        <button type="submit">Szukaj aut</button>
    </form>
</section>

<section class="features">
    <h2>Dlaczego warto wybrać Carfuse?</h2>
    <div class="feature-list">
        <div class="feature">✔ Gwarancja najlepszych cen</div>
        <div class="feature">✔ Wsparcie klienta 24/7</div>
        <div class="feature">✔ Elastyczne warunki wynajmu</div>
    </div>
</section>

<?php include __DIR__ . '/layouts/footer.php'; ?>

</body>
</html>
=== DocumentManager/Views/signing_page.php ===
=== DocumentManager/Views/user_documents.php ===
=== DocumentManager/Views/admin_documents.php ===
=== AuditManager/Views/admin/audit_logs.php ===
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Audit Logs</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-5">
        <h1 class="text-center">Audit Logs</h1>
        
        <!-- Filters -->
        <form id="filterForm" class="row mb-4">
            <div class="col-md-3">
                <input type="text" class="form-control" name="user_id" placeholder="User ID" value="<?= $_GET['user_id'] ?? '' ?>">
            </div>
            <div class="col-md-3">
                <input type="text" class="form-control" name="booking_id" placeholder="Booking ID" value="<?= $_GET['booking_id'] ?? '' ?>">
            </div>
            <div class="col-md-3">
                <input type="date" class="form-control" name="start_date" placeholder="Start Date" value="<?= $_GET['start_date'] ?? '' ?>">
            </div>
            <div class="col-md-3">
                <input type="date" class="form-control" name="end_date" placeholder="End Date" value="<?= $_GET['end_date'] ?? '' ?>">
            </div>
            <div class="col-md-12 mt-2 text-end">
                <button type="submit" class="btn btn-primary">Filter</button>
            </div>
        </form>

        <!-- Logs Table -->
        <table class="table table-bordered table-striped">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Action</th>
                    <th>Details</th>
                    <th>User ID</th>
                    <th>Booking ID</th>
                    <th>IP Address</th>
                    <th>Created At</th>
                </tr>
            </thead>
            <tbody>
                <?php if (!empty($logs)): ?>
                    <?php foreach ($logs as $log): ?>
                        <tr>
                            <td><?= $log['id'] ?></td>
                            <td><?= $log['action'] ?></td>
                            <td><?= $log['details'] ?></td>
                            <td><?= $log['user_id'] ?? '-' ?></td>
                            <td><?= $log['booking_id'] ?? '-' ?></td>
                            <td><?= $log['ip_address'] ?? '-' ?></td>
                            <td><?= $log['created_at'] ?></td>
                        </tr>
                    <?php endforeach; ?>
                <?php else: ?>
                    <tr>
                        <td colspan="7" class="text-center">No logs found.</td>
                    </tr>
                <?php endif; ?>
            </tbody>
        </table>
    </div>
</body>
</html>
