class Ajax{constructor(){this.baseUrl="/api",this.token=localStorage.getItem("auth_token")||null}async request(t,e="GET",o=null){t=""+this.baseUrl+t,e={method:e,headers:{"Content-Type":"application/json",Authorization:this.token?"Bearer "+this.token:""}};o&&(e.body=JSON.stringify(o));try{var r=await fetch(t,e);if(r.ok)return await r.json();throw new Error("HTTP error! status: "+r.status)}catch(t){throw console.error("API call failed:",t),t}}get(t){return this.request(t,"GET")}post(t,e){return this.request(t,"POST",e)}put(t,e){return this.request(t,"PUT",e)}delete(t){return this.request(t,"DELETE")}}let ajax=new Ajax;export default ajax;import ajax from"./ajax.js";import{showToast}from"./toasts.js";function validateForm(t){let e=!0;return t.querySelectorAll("input, textarea, select").forEach(t=>{t.hasAttribute("required")&&""===t.value.trim()?(t.classList.add("is-invalid"),e=!1):t.classList.remove("is-invalid")}),e}function handleFormSubmission(t,e,o=null){validateForm(t)?(t=new FormData(t),t=Object.fromEntries(t),ajax.post(e,t).then(t=>{showToast("success",t.message||"Action completed!"),o&&setTimeout(()=>{window.location.href=o},1500)}).catch(t=>showToast("error","Something went wrong."))):showToast("error","Please fill in all required fields!")}document.getElementById("loginForm")?.addEventListener("submit",async function(t){t.preventDefault();t=new FormData(this),t=Object.fromEntries(t);try{var e=await ajax.post("/auth/login",t);localStorage.setItem("auth_token",e.access_token),showToast("success","Login successful!"),setTimeout(()=>window.location.href="/dashboard",1e3)}catch(t){showToast("error","Login failed. Please check your credentials.")}}),document.getElementById("logoutBtn")?.addEventListener("click",async function(){try{await ajax.post("/auth/logout"),localStorage.removeItem("auth_token"),showToast("success","Logged out successfully."),setTimeout(()=>window.location.href="/",1e3)}catch(t){showToast("error","Logout failed.")}});import ajax from"./ajax.js";import{validateForm}from"./forms.js";import{showToast}from"./toasts.js";function showToast(e,o){var r=document.getElementById("toast-container");if(r){let t=document.createElement("div");t.className="toast toast-"+e,t.innerText=o,r.appendChild(t),setTimeout(()=>t.remove(),3e3)}else console.error("Toast container missing!")}document.addEventListener("DOMContentLoaded",function(){console.log("Main.js Loaded"),document.querySelectorAll("form").forEach(e=>{e.addEventListener("submit",function(t){validateForm(e)||(t.preventDefault(),showToast("error","Form validation failed!"))})})});class API{constructor(){this.baseUrl="/api",this.token=localStorage.getItem("token")||null}setToken(t){this.token=t,localStorage.setItem("token",t)}async request(e,o="GET",t=null,r=3){var a=""+this.baseUrl+e,s={method:o,headers:{"Content-Type":"application/json",Authorization:this.token?"Bearer "+this.token:""}};t&&(s.body=JSON.stringify(t));try{var n=await fetch(a,s);if(n.ok)return await n.json();if(0<r&&500<=n.status)return this.request(e,o,t,r-1);throw new Error(`HTTP ${n.status}: `+n.statusText)}catch(t){throw console.error("API Error:",t),this.logError(t,e,o),t}}logError(t,e,o){fetch("/logs/js-errors.log",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({error:t.message,endpoint:e,method:o,timestamp:(new Date).toISOString()})}).catch(t=>console.error("Logging failed:",t))}}let api=new API;export default api;export{validateForm,handleFormSubmission,showToast};