RewriteEngine On
RewriteBase /

# Ensure PHP files are executed
AddHandler application/x-httpd-php .php

# Block direct access to API PHP files
RewriteCond %{REQUEST_URI} ^/api/.*\.php$
RewriteRule ^ - [F,L]

# Rewrite static files (CSS, JS, Images) to load correctly without "public/"
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_URI} ^/(css|js|images)/(.*)$
RewriteRule ^(css|js|images)/(.*)$ public/$1/$2 [L]

# Ensure /dashboard, /profile, and /login load correctly through index.php
RewriteRule ^(dashboard|profile|login)$ index.php [L]

# Ensure FastRoute processes non-static requests
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^ index.php [QSA,L]

# PHP session configuration (ensure proper session handling)
php_flag session.auto_start on
php_value session.use_cookies 1
php_value session.use_only_cookies 1
